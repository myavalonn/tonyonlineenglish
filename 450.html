<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tonyç·šä¸Šç¾èªå®¶æ•™ - èª²ç¨‹æ–¹æ¡ˆ</title>
  <style>
    /* =========================================
       1. åŸå§‹è³¼ç‰©è»Šèˆ‡åŸºç¤æ¨£å¼ (å®Œå…¨ä¿ç•™æ‚¨åŸæœ¬çš„è¨­å®š)
       ========================================= */
    #embedding-container { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background-color: #f0f2f5; padding: 20px 0; }
    .product-widget { max-width: 560px; width: 90%; margin: 40px auto; background-color: white; border-radius: 12px; box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); overflow: hidden; }
    .image-gallery { position: relative; overflow: hidden; background-color: #eee; }
    .gallery-track { display: flex; transition: transform 0.5s ease-in-out; }
    .gallery-slide { min-width: 100%; box-sizing: border-box; }
    .gallery-slide img { width: 100%; display: block; }
    .product-info { padding: 32px; position: relative; }
    .product-info h1 { font-size: 28px; color: #333; margin: 0 0 10px 0; line-height: 1.3; }
    .product-info h2 { font-size: 22px; color: #555; margin: 0; font-weight: 500;}
    .subtitle-wrapper { display: flex; flex-direction: column; align-items: flex-start; gap: 8px; margin-bottom: 25px; }
    .subtitle-note { font-size: 16px; color: #777; }
    .option-selector { display: flex; flex-direction: column; gap: 10px; margin-bottom: 25px; }
    .option-selector label { font-size: 18px; color: #555; font-weight: bold; }
    .option-selector select { font-size: 18px; padding: 10px 14px; border: 1px solid #ccc; border-radius: 6px; width: 100%; box-sizing: border-box; }
    .option-selector select, .option-selector option { color: #007bff; }
    .option-selector option { font-size: 16px; padding: 5px; }
    #add-to-cart-btn { width: 100%; background-color: #3b414a; color: white; border: none; padding: 18px 20px; font-size: 20px; font-weight: bold; border-radius: 8px; cursor: pointer; transition: background-color 0.3s ease; }
    .cart-icon-wrapper { position: absolute; top: 32px; right: 32px; font-size: 36px; cursor: pointer; color: #333; z-index: 10; }
    .cart-count { position: absolute; top: -8px; right: -12px; background-color: red; color: white; border-radius: 50%; width: 22px; height: 22px; font-size: 14px; font-weight: bold; display: flex; justify-content: center; align-items: center; transition: transform 0.2s ease; transform: scale(0); }
    .cart-count.visible { transform: scale(1); }
    .cart-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.5s ease, visibility 0.5s ease; }
    .cart-overlay.open { opacity: 1; visibility: visible; }
    .cart-panel { position: fixed; top: 0; right: -100%; width: 90%; max-width: 800px; height: 100%; background-color: #f9f9f9; box-shadow: -5px 0 15px rgba(0,0,0,0.1); z-index: 1001; transition: right 0.5s ease-in-out; display: flex; flex-direction: column; }
    .cart-panel.open { right: 0; }
    .cart-body { display: flex; flex-grow: 1; padding: 0 20px 20px 20px; gap: 40px; overflow-y: auto; }
    .cart-left, .cart-right { flex-basis: 50%; background-color: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; }
    .cart-left { position: relative; }
    .cart-left h3 { margin-top: 0; }
    #close-cart-btn-main { position: absolute; top: 20px; right: 20px; background: none; border: none; font-size: 28px; line-height: 1; cursor: pointer; color: #888; padding: 0; }
    .cart-item { display: flex; justify-content: space-between; align-items: flex-start; gap: 15px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
    .cart-item-info { display: flex; flex-direction: column; gap: 8px; align-items: flex-start; }
    .cart-item-name { font-weight: bold; }
    .remove-item-btn { background: none; border: none; color: #999; cursor: pointer; font-size: 14px; text-decoration: underline; padding: 0; white-space: nowrap; }
    .cart-item-price { font-weight: bold; white-space: nowrap; text-align: right; color: red; } 
    .cart-total { margin-top: 20px; padding-top: 20px; border-top: 2px solid #333; }
    .cart-total .total-row { display: flex; justify-content: space-between; font-size: 18px; line-height: 1.6; }
    .cart-total .total-row.final-total { font-size: 22px; font-weight: bold; }
    .cart-total .final-total span:last-child { color: red; } 
    #checkout-form p { color: #555; }
    .line-link { font-weight: bold; color: #00B900; text-align: center; margin-bottom: 15px; display: block; text-decoration: none;}
    #checkout-form input[type="email"] { width: 100%; padding: 12px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 15px; box-sizing: border-box; cursor: pointer; }
    #checkout-form button { width: 100%; background-color: #3b414a; color: white; border: none; padding: 15px; font-size: 18px; font-weight: bold; border-radius: 6px; cursor: pointer; transition: background-color 0.3s ease; }
    .tls-info { text-align: center; color: #888; font-size: 12px; margin-top: 15px; }
    .payment-info-section { margin-top: 15px; padding-top: 20px; border-top: 1px solid #eee; }
    .payment-method { background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 6px; padding: 15px; display: flex; align-items: center; gap: 15px; font-size: 15px; }
    .icon-circle { border: 2px solid black; border-radius: 50%; width: 18px; height: 18px; display: flex; justify-content: center; align-items: center; flex-shrink: 0; }
    .icon-circle div { width: 8px; height: 8px; background-color: black; border-radius: 50%; }
    .payment-method.custom-style { background-color: black; }
    .payment-method.custom-style span { color: white; }
    .payment-method.custom-style .icon-circle { border-color: white; }
    .payment-method.custom-style .icon-circle div { background-color: white; }
    #thank-you-page { display: none; padding: 20px; box-sizing: border-box; }
    .thank-you-container { max-width: 900px; width: 100%; margin: 0 auto; background-color: #f9f9f9; border: 1px solid #e0e0e0; }
    .ty-left-panel { background-color: white; padding: 40px; }
    .ty-right-panel { background-color: #f9f9f9; padding: 40px; }
    .ty-checkmark { font-size: 48px; color: #27ae60; }
    .ty-header { display: flex; align-items: center; gap: 15px; font-size: 28px; color: #333; margin: 15px 0; }
    .ty-message { color: #555; line-height: 1.6; }
    .ty-order-details { margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; }
    .ty-detail-item { display: flex; justify-content: space-between; padding: 8px 0; font-size: 14px; align-items: center; }
    .ty-summary-header { font-size: 18px; color: #555; margin: 0 0 20px 0; border-bottom: 1px solid #ddd; padding-bottom: 10px;}
    .ty-order-item { padding-bottom: 15px; border-bottom: 1px solid #eee; }
    .ty-item-details { display: flex; justify-content: space-between; align-items: flex-start; gap: 15px; }
    .ty-item-info { font-weight: bold; }
    .ty-item-price { font-weight: bold; white-space: nowrap; }
    #ty-order-id { font-size: 2em; color: #007bff; font-weight: bold; }
    .ty-booking-link { display: block; background-color: #007bff; color: white !important; padding: 12px 20px; border-radius: 8px; text-decoration: none; text-align: center; font-weight: bold; margin-top: 10px; margin-bottom: 10px; transition: background-color 0.3s ease; }
    .ty-booking-link:hover { background-color: #0056b3; }
    .ty-line-link { color: green; font-weight: bold; text-decoration: none; }
    #continue-shopping-btn { color: blue; }
    #close-btn { color: red; margin-left: 20px; }

    /* --- Confetti Eruption Animation --- */
    #celebration-icon { font-size: 1.5em; position: relative; display: inline-block; z-index: 1;}
    @keyframes confetti-eruption {
      0% { opacity: 1; transform: translate(-50%, 20%) scale(0); }
      30% { opacity: 1; }
      100% {
        opacity: 0;
        box-shadow: -15px -35px 0 -3px #e74c3c, 15px -35px 0 -3px #3498db, -25px -20px 0 -3px #f1c40f, 25px -20px 0 -3px #2ecc71, 0px -45px 0 -3px #9b59b6, -10px -50px 0 -3px orange, 10px -50px 0 -3px hotpink;
        transform: translate(-50%, -20px) scale(1.5) rotate(15deg);
      }
    }
    .celebration-icon::before {
      content: ''; position: absolute; bottom: 5px; left: 50%;
      width: 8px; height: 8px; border-radius: 2px;
      background-color: transparent;
      box-shadow: 0 0 0 0 #e74c3c, 0 0 0 0 #3498db, 0 0 0 0 #f1c40f, 0 0 0 0 #2ecc71, 0 0 0 0 #9b59b6, 0 0 0 0 orange, 0 0 0 0 hotpink;
      animation: confetti-eruption 1.5s ease-out infinite; z-index: -1;
    }
    .celebration-icon::after { display: none; }
    
    /* Futuristic Pill Banner Style */
    .futuristic-pill-banner { display: inline-block; padding: 10px 25px; font-family: 'Noto Sans TC', sans-serif; font-size: 16px; font-weight: 500; color: white; background: linear-gradient(110deg, #5E32E2 0%, #A259FF 100%); border-radius: 50px; box-shadow: 0 4px 15px rgba(94, 50, 226, 0.4); text-shadow: 0 0 8px rgba(255, 255, 255, 0.3); transition: transform 0.3s ease, box-shadow 0.3s ease; margin: 0; }
    .futuristic-pill-banner:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(94, 50, 226, 0.5); }
    .banner-break { display: none; }
    
    /* Email Popup Styles */
    #email-popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 2000; display: none; justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s ease-in-out; }
    #email-popup-overlay.visible { display: flex; opacity: 1; }
    .email-popup-content { background-color: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); position: relative; width: 90%; max-width: 500px; text-align: center; transform: scale(0.9); transition: transform 0.3s ease-in-out; }
    #email-popup-overlay.visible .email-popup-content { transform: scale(1); }
    #close-popup-btn { position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 28px; cursor: pointer; color: #888; }
    .email-popup-content label { font-size: 22px; color: #333; display: block; margin-bottom: 15px; }
    .email-popup-content input[type="email"] { width: 100%; padding: 15px; font-size: 20px; border: 2px solid #007bff; border-radius: 8px; box-sizing: border-box; text-align: center; }
    #popup-checkout-btn { width: 100%; background-color: #3b414a; color: white; border: none; padding: 15px; font-size: 20px; font-weight: bold; border-radius: 8px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 20px; }
    #popup-checkout-btn:hover { background-color: #525964; }

    /* Image Gallery Styles */
    .gallery-nav { position: absolute; top: 50%; transform: translateY(-50%); width: 100%; display: flex; justify-content: space-between; pointer-events: none; z-index: 5; }
    .gallery-nav button { pointer-events: auto; background-color: rgba(0, 0, 0, 0.4); color: white; border: none; font-size: 28px; font-weight: bold; cursor: pointer; border-radius: 50%; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; margin: 0 15px; line-height: 1; transition: background-color 0.3s ease; }
    .gallery-nav button:hover { background-color: rgba(0, 0, 0, 0.7); }
    .gallery-dots { position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; z-index: 5; }
    .gallery-dot { width: 12px; height: 12px; background-color: rgba(255, 255, 255, 0.6); border-radius: 50%; cursor: pointer; transition: background-color 0.3s ease, transform 0.3s ease; border: 1px solid rgba(0, 0, 0, 0.2); }
    .gallery-dot.active { background-color: white; transform: scale(1.1); }

    /* Media Queries for Original Cart */
    @media (min-width: 1025px) {
      .thank-you-container { display: flex; gap: 30px; }
      .ty-left-panel { flex-basis: 55%; }
      .ty-right-panel { flex-basis: 45%; }
    }
    @media (min-width: 768px) and (max-width: 1024px) {
      .product-widget { max-width: 700px; margin: 50px auto; }
      .product-info { padding: 45px; }
      .product-info h1 { font-size: 38px; }
      .product-info h2 { font-size: 28px; }
      .option-selector label, .option-selector select { font-size: 22px; }
      #add-to-cart-btn { font-size: 24px; padding: 20px 22px; }
      .thank-you-container { flex-direction: column; display: block; }
    }
    @media (max-width: 767px) {
      .product-widget { max-width: 400px; margin: 20px auto; }
      .product-info { padding: 24px; }
      .product-info h1 { font-size: 22px; margin-bottom: 5px; }
      .product-info h2 { font-size: 18px; }
      .option-selector label, .option-selector select { font-size: 16px; }
      #add-to-cart-btn { font-size: 18px; padding: 15px 20px; }
      .cart-icon-wrapper { top: 30px; right: 25px; font-size: 32px; }
      .cart-panel { width: 100%; max-width: 100%; }
      .cart-body { flex-direction: column; gap: 20px; padding: 0 15px 15px 15px; }
      .cart-left, .cart-right { flex-basis: auto; }
      #close-cart-btn-main { top: 15px; right: 15px; }
      .thank-you-container { flex-direction: column; }
      .ty-left-panel, .ty-right-panel { padding: 25px; }
      .banner-break { display: inline; }
      .futuristic-pill-banner { text-align: center; border-radius: 25px; }
    }


    /* =========================================
       2. æ–°å¢å€å¡Šæ¨£å¼ (Heroã€Table 3&5ã€Photo 3ã€FAQ)
       ========================================= */
    body { margin: 0; padding: 0; background-color: #f4f6f9; }
    
    /* Hero Section (Photo 1) */
    .hero-section { background-image: linear-gradient(rgba(40, 30, 80, 0.7), rgba(40, 30, 80, 0.7)), url('https://images.unsplash.com/photo-1514565131-fce0801e5785?auto=format&fit=crop&w=2000&q=80'); background-size: cover; background-position: center; padding: 120px 20px; text-align: left; display: flex; align-items: center; justify-content: flex-start; margin-bottom: 20px; }
    .hero-section-inner { max-width: 1200px; width: 100%; margin: 0 auto; }
    .hero-section h1 { color: white; font-size: 3.5rem; margin: 0; line-height: 1.3; text-shadow: 2px 2px 10px rgba(0,0,0,0.5); font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; font-weight: 500; letter-spacing: 2px; }

    /* Photo 2 Checklist Style (Inserted inside original widget safely) */
    .photo2-checklist { margin: 25px 0; border-top: 1px solid #eee; padding-top: 20px;}
    .photo2-checklist p { font-size: 15px; font-weight: bold; margin-bottom: 15px; color: #444; }
    .photo2-checklist ul { list-style: none; padding: 0; margin: 0; }
    .photo2-checklist li { display: flex; align-items: flex-start; margin-bottom: 12px; font-size: 14px; color: #444; line-height: 1.6; }
    .check-icon { margin-right: 10px; font-size: 16px; color: #333; font-style: normal; }
    .warning-icon { margin-right: 10px; font-size: 16px; font-style: normal; }

    /* Tables Container (Code 3 & Code 5) */
    .extra-sections-wrapper { max-width: 1000px; margin: 40px auto; padding: 0 15px; }

    /* Sub-Table (Code 3) */
    .sub-container { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; margin: 20px 0 40px 0; }
    .sub-table { border-collapse: collapse; margin: 10px auto; font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; width: 100%; box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1); border-radius: 15px; overflow: hidden; border: 1px solid #ddd; table-layout: fixed; background: white;}
    .sub-table thead tr { background: linear-gradient(135deg, #8a4fff, #6b38e8); color: #ffffff; }
    .relative-cell { position: relative; vertical-align: middle; }
    .bonus-gif { position: absolute; top: 2px; left: 2px; z-index: 1; width: 35px; height: auto; }
    .sub-table th { padding: 12px 5px; font-size: 15px; }
    .sub-table td { padding: 30px 5px 15px 5px; text-align: center; border-bottom: 1px solid #eee; border-right: 1px solid #eee; }
    .price-text { font-weight: bold; font-size: 16px; color: #333; }
    .class-count { font-size: 15px; color: #666; font-weight: bold; }
    .points-text { font-size: 18px; font-weight: 900; color: #8a4fff; }
    .promo-note { background-color: #f6f0ff; color: #5a2caf; font-weight: bold; font-size: 14px; padding: 15px !important; }

    /* Time Slot Table (Code 5) */
    .table-container { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; margin: 20px 0; }
    .price-table { border-collapse: collapse; margin: 10px auto; font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; width: 100%; box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15); border-radius: 12px; overflow: hidden; border: 1px solid #ddd; table-layout: fixed; background: white;}
    .price-table thead tr { background-color: #e63946; color: #ffffff; }
    .price-table th { padding: 10px 5px; font-size: 14px; }
    .en-sub { display: block; font-size: 9px; opacity: 0.9; text-transform: uppercase; }
    .price-table td { padding: 12px 5px; text-align: center; border-bottom: 1px solid #eee; border-right: 1px solid #eee; }
    .bold-time { font-weight: bold; font-size: 14px; color: #333; background-color: #fafafa; }
    .time-sub { font-size: 11px; color: #888; display: block; }
    .weekday-price { font-size: 18px; font-weight: bold; color: #444; }
    .blue-price { color: #007bff; }
    .holiday-cell { font-size: 22px; font-weight: 900; color: #e63946; background-color: #fffafa; }
    .note-row { background-color: #fdf2f2; color: #d62828; font-weight: bold; font-size: 13px; }
    .note-cell { padding: 15px !important; border-right: none !important; }

    /* Info Block Section (Photo 3) */
    .info-block { background-color: #f8faf5; padding: 50px 20px; text-align: center; font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; line-height: 1.8; margin: 40px auto; border-radius: 12px; border: 1px solid #e8ede3; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    .info-block p.top-highlight { font-weight: bold; font-size: 18px; margin-bottom: 40px; color: #222; }
    .info-block h2 { font-size: 26px; color: #333; margin-top: 30px; margin-bottom: 15px; font-weight: normal;}
    .info-block h3 { font-size: 24px; margin-bottom: 40px; line-height: 1.5; font-weight: normal; }
    .text-orange { color: #e67e22; font-weight: bold; }
    .text-green { color: #2ecc71; font-weight: bold; }
    .diamond-list { list-style: none; padding: 0; display: inline-block; text-align: left; margin: 20px 0; font-weight: bold; font-style: italic; color: #2c3e50; font-size: 18px;}
    .diamond-list li { margin-bottom: 15px; }
    .text-pink { color: #ff52b4; font-weight: bold; font-style: italic; font-size: 18px; margin: 15px 0; }
    .info-action-text { font-size: 18px; color: #333; margin: 30px 0; }
    .info-quote { font-size: 20px; color: #333; margin: 40px 0; }
    .limit-text { font-size: 18px; color: #333; margin-top: 40px; }
    .text-blue-outline { color: #3498db; }
    .line-link-bottom { display: inline-block; color: #2c3e50; text-decoration: underline; font-weight: bold; font-size: 20px; margin-top: 20px; }

    /* FAQ Section (Photo 4) */
    .faq-section { max-width: 800px; margin: 60px auto; padding: 20px; font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; }
    .faq-section h2 { text-align: center; font-size: 32px; margin-bottom: 40px; color: #222;}
    .faq-item { border-top: 1px solid #eaeaea; padding: 20px 0; }
    .faq-item:last-child { border-bottom: 1px solid #eaeaea; }
    .faq-question { width: 100%; text-align: center; background: none; border: none; font-size: 20px; font-weight: 500; color: #333; cursor: pointer; display: flex; justify-content: center; align-items: center; padding: 10px 0; outline: none; position: relative; }
    .faq-question .icon { position: absolute; right: 10px; font-size: 24px; font-weight: 300; transition: transform 0.3s ease; color: #888;}
    .faq-answer { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; color: #555; text-align: center; font-size: 16px; }
    .faq-answer p { padding-top: 20px; margin: 0; line-height: 1.8; }
    .faq-answer a { color: #e67e22; text-decoration: none; }
    .faq-question.active .icon { transform: rotate(45deg); }
    .faq-answer .text-blue { color: #3498db; }
    .faq-answer .text-green { color: #2ecc71; }
    .faq-answer .text-red { color: #e74c3c; }

    /* RWD for New Sections */
    @media screen and (min-width: 768px) {
      .hero-section h1 { font-size: 4rem; text-align: left; }
      .price-table th { font-size: 22px; padding: 20px; }
      .en-sub { font-size: 14px; }
      .price-table td { padding: 25px 10px; }
      .bold-time { font-size: 22px; }
      .time-sub { font-size: 16px; }
      .weekday-price { font-size: 36px; }
      .holiday-cell { font-size: 48px; }
      .note-row { font-size: 20px; }
      .sub-table th { font-size: 22px; padding: 20px; }
      .sub-table td { padding: 50px 10px 25px 10px; }
      .price-text { font-size: 24px; }
      .class-count { font-size: 22px; }
      .points-text { font-size: 28px; }
      .promo-note { font-size: 18px; }
      .bonus-gif { width: 55px; top: 5px; left: 5px; }
    }
    @media screen and (min-width: 1200px) {
      .hero-section { padding: 150px 20px; }
      .hero-section h1 { font-size: 5rem; }
      .price-table th { font-size: 32px; padding: 30px; }
      .en-sub { font-size: 18px; margin-top: 5px; }
      .price-table td { padding: 40px 15px; }
      .bold-time { font-size: 32px; }
      .time-sub { font-size: 20px; }
      .weekday-price { font-size: 60px; }
      .holiday-cell { font-size: 85px; }
      .note-row { font-size: 28px; padding: 25px !important; }
      .sub-table th { font-size: 32px; padding: 35px; }
      .sub-table td { padding: 80px 15px 40px 15px; }
      .price-text { font-size: 40px; }
      .class-count { font-size: 36px; }
      .points-text { font-size: 55px; }
      .promo-note { font-size: 28px; padding: 30px !important; }
      .bonus-gif { width: 90px; top: 10px; left: 10px; }
    }
    @media (max-width: 767px) {
      .hero-section h1 { font-size: 2.5rem; text-align: center;}
      .hero-section { justify-content: center; }
    }
  </style>
</head>
<body>

<!-- æ–°å¢ï¼šé ‚éƒ¨ Hero æ©«å¹… (Photo 1) -->
<div class="hero-section">
  <div class="hero-section-inner">
    <h1>é™æ™‚ç‰¹æ®Šæ™‚æ®µå„ªæƒ ï¼<br>æ¯å ‚åªéœ€450é»</h1>
  </div>
</div>

<!-- å®Œå…¨ä¿ç•™æ‚¨çš„åŸå§‹è³¼ç‰©è»Šæ ¸å¿ƒå®¹å™¨ -->
<div id="embedding-container">
  <div id="product-page">
    <div class="product-widget">
        <div class="image-gallery"><div class="gallery-track"></div></div>
        <div class="product-info">
            <div id="cart-icon" class="cart-icon-wrapper">ğŸ›’<span id="cart-count" class="cart-count">0</span></div>
            
            <!-- æ‚¨åŸæœ¬çš„æ¨™é¡Œèˆ‡é™„æ¨™ -->
            <h1>æœƒå“¡è¨‚é–±åˆ¶ æ¯é€±å›ºå®šå…©å ‚</h1>
            <div class="subtitle-wrapper">
                <p style="color: blue; font-size: 16px; margin: 0;">ï¼ˆ1-1æ¯å ‚50åˆ†é˜ï¼‰</p>
                <p class="futuristic-pill-banner">ï¼ˆä¸€æ¬¡è³¼è²·å…©æœŸè´ˆé€<br class="banner-break">å…©å ‚èª²1350é»æˆ–äº”å ‚èª²2250é»ï¼‰</p>
                <div style="display: flex; gap: 10px; align-items: center; margin-top: 10px; flex-wrap: wrap;">
                    <a href="https://tonyonlineenglish.mydurable.com/allcourses" target="_blank" style="color: blue; font-size: 16px; text-decoration: none; display: flex; align-items: center; gap: 5px;">
                        <img src="https://ik.imagekit.io/lql1uveoc/external-link.png?updatedAt=1754911187731" style="width: 12px; height: 12px;">æ‰€æœ‰èª²ç¨‹ä»‹ç´¹
                    </a>
                    <span style="color: #ccc;">|</span>
                    <a href="https://tonyonlineenglish.mydurable.com/regulations" target="_blank" style="color: black; font-size: 16px; text-decoration: none; display: flex; align-items: center; gap: 5px;">
                        <img src="https://ik.imagekit.io/lql1uveoc/external-link.png?updatedAt=1754911187731" style="width: 12px; height: 12px;">è«‹å‡-èª¿èª²è¦ç¯„
                    </a>
                </div>
            </div>

            <!-- åµŒå…¥ Photo 2 çš„æ–‡å­—æ¸…å–® (ä¸å¹²æ“¾åŸæœ¬çµæ§‹) -->
            <div class="photo2-checklist">
              <p>é©åˆæ¯é€±å›ºå®šå…©å ‚èª²ç¨‹çš„å­¸å“¡</p>
              <ul>
                  <li><i class="check-icon">âœ“</i> æ¯é€±å›ºå®šã€900é»ã€è¨‚é–±æ‰£é™¤ï¼Œç•¶å‘¨æ²’æœ‰ä¸Šèª²ä¹Ÿæœƒæ‰£é™¤</li>
                  <li><i class="check-icon">âœ“</i> é©ç”¨ä¸Šèª²æ™‚æ®µ é€±ä¸€ï½é€±äº” ï¼ˆå¹³æ—¥ï¼‰ ä¸Šåˆ10:00am~5:00pmå‰</li>
                  <li><i class="check-icon">âœ“</i> æ¯é€±ç¬¬ä¸‰å ‚æˆ–å¹³æ—¥5pmå¾Œï¼šã€550é»ã€ *é€±å…­åŠåœ‹å®šå‡æ—¥æ¯å ‚ï¼šã€600é»ã€</li>
                  <li><i class="check-icon">âœ“</i> 2026 (æœƒå¦è¡Œå…¬å‘Š) é€£å‡ç•¶é€±ä¸è‡ªå‹•æ‰£é™¤é»æ•¸ï¼Œä½†ä»å¯é ç´„ä¸Šèª²</li>
                  <li><i class="check-icon">âœ“</i> èª²ç¨‹æœŸé–“æœƒå“¡æ“æœ‰ã€å…©æ¬¡ã€æš«åœèª²ç¨‹æ¬Šç›Šã€‚(ä¸é™æ™‚é•·)</li>
                  <li><i class="check-icon">âœ“</i> æœŸé–“è½‰æ–¹æ¡ˆï¼Œæ”¹ç‚ºéè¨‚é–±åˆ¶ï¼Œæ¯å ‚ã€550ã€é»ã€‚é€±å…­åŠåœ‹å®šå‡æ—¥èª²ç¨‹æ¯å ‚ï¼šã€600é»ã€</li>
                  <li><i class="check-icon">âœ“</i> ã€24å°æ™‚å…§ã€æå‡ºè«‹å‡æˆ–èª¿èª²ï¼Œã€æ‰£é™¤0.5å ‚ã€ (è©²æ™‚æ®µé»æ•¸)</li>
                  <li><i class="check-icon">âœ“</i> ã€12å°æ™‚å…§ã€æå‡ºè«‹å‡æˆ–èª¿èª²ï¼Œã€æ‰£é™¤1å ‚ã€ (è©²æ™‚æ®µé»æ•¸)</li>
                  <li><i class="warning-icon">âš ï¸</i> é€±å…­å’Œåœ‹å®šå‡æ—¥èª²ç¨‹éœ€æ–¼ä¸Šèª²å‰ 24 å°æ™‚æå‡ºè«‹å‡æˆ–èª¿èª²ï¼›è‹¥æœªæ–¼24 å°æ™‚å‰æå‡ºï¼Œç•¶å ‚èª²è¦–ç‚ºå·²ä½¿ç”¨ã€‚</li>
                  <li><i class="check-icon">âœ“</i> Special Offer å„ªæƒ  â¬‡ï¸â¬‡ï¸â¬‡ï¸â¬‡ï¸â¬‡ï¸</li>
              </ul>
            </div>

            <!-- æ‚¨åŸæœ¬çš„è³¼ç‰©è»Šé¸é …å€ -->
            <div class="option-selector">
                <label for="course-options">
                    <span style="color: black; font-size: 18px; font-weight: bold;">é¸æ“‡èª²ç¨‹æ–¹æ¡ˆ</span>
                </label>
                <select id="course-options"></select>
            </div>
            <button id="add-to-cart-btn"></button>
        </div>
    </div>
    
    <!-- æ‚¨åŸæœ¬çš„å´é‚Šè³¼ç‰©è»Šç•«é¢ -->
    <div id="cart-overlay" class="cart-overlay"></div>
    <div id="cart-panel" class="cart-panel">
        <div class="cart-body">
            <div class="cart-left">
                <h3>è³¼ç‰©è»Š <button class="close-btn" id="close-cart-btn-main">Ã—</button></h3>
                <div id="cart-items-container"></div>
                <div id="cart-total-container" class="cart-total">
                </div>
            </div>
            <div class="cart-right">
                <h3>çµå¸³</h3>
                <form id="checkout-form" onsubmit="return false;">
                    <p>è«‹è¼¸å…¥æ‚¨çš„é›»å­ä¿¡ç®±ã€‚</p>
                    <input type="email" id="email" required readonly placeholder="é»æ“Šé€™è£¡è¼¸å…¥ä¿¡ç®±">
                    <a class="line-link" href="https://line.me/ti/p/T9YdimtG8_" target="_blank">è«‹åŠ å…¥Line: Myavalon</a>
                    <div class="payment-info-section">
                        <h3>ä»˜æ¬¾è³‡è¨Š</h3>
                        <div class="payment-method custom-style">
                            <div class="icon-circle"><div></div></div>
                            <span>åŒ¯æ¬¾æˆ–å¯ä»¥ä½¿ç”¨Line Pay/iPassMoney ä»˜æ¬¾</span>
                        </div>
                    </div>
                    <p class="tls-info">æ‰€æœ‰æ•¸æ“šéƒ½é€éå®‰å…¨ TLS é€£ç·šé€²è¡ŒåŠ å¯†å‚³è¼¸</p>
                </form>
            </div>
        </div>
    </div>
  </div>
  
  <!-- æ‚¨åŸæœ¬çš„ä¿¡ç®±å½ˆçª— -->
  <div id="email-popup-overlay">
      <div class="email-popup-content">
          <button id="close-popup-btn">Ã—</button>
          <label for="popup-email-input">è«‹è¼¸å…¥æ‚¨çš„é›»å­ä¿¡ç®±</label>
          <input type="email" id="popup-email-input" required placeholder="example@email.com">
          <button id="popup-checkout-btn">ç¢ºèª</button>
      </div>
  </div>

  <!-- æ‚¨åŸæœ¬çš„ç²¾ç¾æ„Ÿè¬é é¢èˆ‡å‹•ç•«çµæ§‹ -->
  <div id="thank-you-page" style="display:none;">
    <div class="thank-you-container">
        <div class="ty-left-panel">
            <div class="ty-checkmark">âœ“</div>
            <h2 class="ty-header">æ„Ÿè¬æ‚¨çš„è¨‚è³¼ï¼<span id="celebration-icon" class="celebration-icon">ğŸ‰</span></h2>
            <p class="ty-message">æ‚¨çš„è¨‚å–®å·²æˆåŠŸå»ºç«‹ã€‚ç¢ºèªä¿¡å·²å¯„é€è‡³æ‚¨çš„é›»å­ä¿¡ç®±ï¼Œè«‹æª¢æŸ¥æ‚¨çš„æ”¶ä»¶åŒ£ã€‚</p>
            <div class="ty-order-details">
                <div class="ty-detail-item"><span>è¨‚å–®ç·¨è™Ÿ</span><span id="ty-order-id"></span></div>
                <div class="ty-detail-item"><span>è¨‚å–®æ™‚é–“</span><span id="ty-order-timestamp"></span></div>
                <div class="ty-detail-item"><span>é›»å­ä¿¡ç®±</span><span id="ty-customer-email"></span></div>
            </div>
            <div id="ty-booking-container" style="display: none; margin-top: 20px;">
                <h3>ä¸‹ä¸€æ­¥ï¼šé ç´„èª²ç¨‹</h3>
                <p>è«‹é»æ“Šä¸‹æ–¹å°ˆå±¬é€£çµï¼Œé ç´„æ‚¨çš„ä¸Šèª²æ™‚é–“ï¼š</p>
                <div id="ty-booking-links-list"></div>
            </div>
            <div class="ty-payment-instructions" style="margin-top: 20px;">
                <h3>å¦‚ä½•ä»˜æ¬¾:</h3>
                <p><a href="https://line.me/ti/p/T9YdimtG8_" target="_blank" class="ty-line-link">è«‹é»é¸åŠ å…¥Line: myavalon</a></p>
                <p>åŒ¯æ¬¾æˆ–å¯ä»¥ä½¿ç”¨Line Pay/iPassMoney ä»˜æ¬¾</p>
                <p>äº¤æ˜“æˆåŠŸå¾Œç…©è«‹å‘ŠçŸ¥<br>å°‡æä¾›å­¸è²»è­‰æ˜<br>æ„Ÿè¬ ï¼¾ï¼¾</p>
            </div>
            <div style="margin-top: 20px;">
              <a href="#" id="continue-shopping-btn">ç¹¼çºŒè³¼ç‰©</a>
              <a href="#" id="close-btn">é—œé–‰</a>
            </div>
        </div>
        <div class="ty-right-panel">
            <h3 class="ty-summary-header">è¨‚å–®æ‘˜è¦</h3>
            <div id="ty-cart-items-container"></div>
            <div id="ty-total-container" class="cart-total">
            </div>
        </div>
    </div>
  </div>
</div>

<!-- =========================================
     æ–°å¢ï¼šä¸‹æ–¹è¡¨æ ¼èˆ‡æ–‡å­—å€å¡Š (å®‰å…¨åœ°åŠ åœ¨åŸå§‹å®¹å™¨ä¹‹å¤–)
     ========================================= -->
<div class="extra-sections-wrapper">
  
  <!-- è¡¨æ ¼ï¼šæ™‚æ®µ (Code 5) -->
  <div class="table-container">
    <table class="price-table">
      <thead>
        <tr>
          <th>æ™‚æ®µ<span class="en-sub">Time Slot</span></th>
          <th>é€±ä¸€è‡³é€±äº”<span class="en-sub">Mon - Fri</span></th>
          <th>é€±å…­ / å‡æ—¥<span class="en-sub">Sat / Holiday</span></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="bold-time">10:00 - 12:00<span class="time-sub">Morning</span></td>
          <td class="weekday-price">450é»</td>
          <td rowspan="3" class="holiday-cell">600é»</td>
        </tr>
        <tr>
          <td class="bold-time">13:00 - 17:00<span class="time-sub">Afternoon</span></td>
          <td class="weekday-price">450é»</td>
        </tr>
        <tr>
          <td class="bold-time">18:00 - 22:00<span class="time-sub">Evening</span></td>
          <td class="weekday-price blue-price">550é»</td>
        </tr>
        <tr class="note-row">
          <td colspan="3" class="note-cell">
            ğŸ’¡ é©ç”¨æ™‚æ®µå…§æ¯é€±ç¬¬ä¸‰å ‚èª²ï¼š550é»
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- è¡¨æ ¼ï¼šæ–¹æ¡ˆé»æ•¸ (Code 3) -->
  <div class="sub-container">
    <table class="sub-table">
      <thead>
        <tr>
          <th>æ–¹æ¡ˆé‡‘é¡</th>
          <th>é è¨ˆå ‚æ•¸/450</th>
          <th>ç²å¾—é»æ•¸</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="price-text">NT$13,500</td>
          <td class="class-count">ç´„ 30 å ‚èª²</td>
          <td class="points-text">13,500 é»</td>
        </tr>
        <tr>
          <td class="price-text">NT$18,000</td>
          <td class="class-count">ç´„ 41 å ‚èª²</td>
          <td class="points-text relative-cell">
            <img src="https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/2026.%20%E6%96%B0%E5%A2%9E18000.36000/coupon.gif" class="bonus-gif">
            18,450 é»
          </td>
        </tr>
        <tr>
          <td class="price-text">NT$27,000</td>
          <td class="class-count">ç´„ 62 å ‚èª²</td>
          <td class="points-text relative-cell">
            <img src="https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/2026.%20%E6%96%B0%E5%A2%9E18000.36000/coupon.gif" class="bonus-gif">
            27,900 é»
          </td>
        </tr>
        <tr>
          <td class="price-text" style="color:#e63946;">NT$36,000</td>
          <td class="class-count">ç´„ 85 å ‚èª²</td>
          <td class="points-text relative-cell" style="color:#e63946;">
            <img src="https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/2026.%20%E6%96%B0%E5%A2%9E18000.36000/coupon.gif" class="bonus-gif">
            38,250 é»
          </td>
        </tr>
        <tr>
          <td colspan="3" class="promo-note">
            ğŸ å„ªæƒ ï¼šä¸€æ¬¡è³¼è²·å…©æœŸ<div class="mobile-br"></div>è´ˆé€å…©å ‚èª²(900é») æˆ– äº”å ‚èª²(2250é»)
            <br>
            <span style="font-size: 0.8em; font-weight: normal; opacity: 0.8;">(1-1 æ¯å ‚ 50 åˆ†é˜)</span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- æ–°å¢ï¼šèªªæ˜å€å¡Š (Photo 3) -->
  <div class="info-block">
      <p class="top-highlight">æ¯é€±ç¬¬ä¸‰å ‚æˆ–å¹³æ—¥5pmå¾Œï¼šã€550é»ã€ *é€±å…­åŠåœ‹å®šå‡æ—¥æ¯å ‚ï¼šã€600é»ã€<br> (è‹¥æœ‰éœ€æ±‚ï¼Œå¯å½ˆæ€§åŠ èª²)</p>
      
      <h2>é©ç”¨æ™‚æ®µï¼š</h2>
      <h3>
          <span class="text-orange">é€±ä¸€è‡³é€±äº”(å¹³å¸¸æ—¥) ç™½å¤©æ™‚æ®µ</span> <span class="text-green">10am-5pm</span><br>
          <span style="color:#333;">çš†å¯é ç´„ï¼Œ(åœ‹å®šå‡æ—¥éœ€çœ‹æƒ…æ³é€²è¡Œé€šçŸ¥)</span>
      </h3>
      
      <ul class="diamond-list">
          <li>â–ä¸€æ¬¡ç¹³è²»ï¼š (ç´„ 30/40+1å ‚èª²ç´„15/21é€±ï¼Œæ¯å ‚ 50 åˆ†é˜)</li>
          <li>â–èª²ç¨‹æœŸé–“å¯ æš«åœä¸Šèª²æœ€å¤š 2 æ¬¡ï¼Œå¯è‡ªç”±é¸æ“‡æ¢å¾©æ™‚é–“</li>
      </ul>

      <p class="text-pink">â—é€£å‡å„ªæƒ ï¼š2026 å°‡å¦è¡Œå…¬å‘Š</p>
      <p class="text-pink">ä¸€æ¬¡è³¼è²·å…©æœŸæœ‰è´ˆé€å ‚æ•¸ã€‚</p>

      <p class="info-action-text">
          å¿«é€Ÿæå‡ï¼šç³»çµ±åŒ–èƒŒå–®å­—ï¼Œå¿«é€Ÿæå‡è‹±èªå¯¦åŠ›ğŸš€<br>
          ç«‹å³å ±åï¼ŒæŠŠæ¡æ©Ÿæœƒï¼ è¶•ç·Šè¯ç¹«ï¼Œäº†è§£æ›´å¤šè©³æƒ…ä¸¦é ç´„é«”é©—èª²ç¨‹ğŸ“²
      </p>

      <p class="info-quote">Tonyç·šä¸Šç¾èªå®¶æ•™ è®“å­¸ç¿’è‹±èªè®Šå¾—æ›´è¼•é¬†ã€æ›´æœ‰æ•ˆç‡ï¼</p>

      <p class="limit-text">
          åé¡æœ‰é™ è«‹æŠŠæ¡æ©Ÿæœƒ<br>
          <span class="text-blue-outline">(Tonyç·šä¸Šç¾èªå®¶æ•™ä¿ç•™éš¨æ™‚çµ‚æ­¢å„ªæƒ æ–¹æ¡ˆçš„æ¬Šåˆ©ã€‚)</span>
      </p>

      <p><a href="https://line.me/ti/p/T9YdimtG8_" class="line-link-bottom" target="_blank">åŠ å…¥Line : myavalon</a></p>
  </div>

  <!-- æ–°å¢ï¼šå¸¸è¦‹å•é¡Œ FAQ (Photo 4) -->
  <div class="faq-section">
      <h2>èª²ç¨‹å¸¸è¦‹å•é¡ŒFAQ</h2>
      
      <div class="faq-item">
          <button class="faq-question">æˆ‘å¯ä»¥é¸æ“‡çš„èª²ç¨‹ç‚ºä½•å‘¢ï¼Ÿ <span class="icon">+</span></button>
          <div class="faq-answer">
              <p>è«‹é» <a href="#">ğŸ”—è©³ç´°èª²ç¨‹ä»‹ç´¹</a>ï¼Œä¸Šè¿°é™³åˆ—çš†å¯ä¸Šèª²ï¼è‹¥æœ‰ç‰¹æ®Šèª²ç¨‹éœ€æ±‚ï¼Œè«‹ç›´æ¥å‘ŠçŸ¥æˆ‘å€‘ã€‚Thanks</p>
          </div>
      </div>
      
      <div class="faq-item">
          <button class="faq-question">ä¸Šèª²æ™‚é–“ç‚ºä½•ï¼Ÿ <span class="icon">+</span></button>
          <div class="faq-answer">
              <p>Tonyç·šä¸Šç¾èªå®¶æ•™ä¸Šèª²æ™‚é–“<br>
              <span class="text-green">é€±ä¸€ï½é€±äº”ï¼š ä¸Šåˆ10:00~æ™šä¸Š10:00</span><br>
              <span class="text-red">é€±å…­ï¼š ä¸Šåˆ 10:00~ä¸‹åˆ5:00 pm</span><br>
              <a href="#">ğŸ”—é»é¸ç·šä¸Šé ç´„ç³»çµ±</a></p>
          </div>
      </div>
      
      <div class="faq-item">
          <button class="faq-question">æˆ‘è¦æ€éº¼çŸ¥é“æˆ‘çš„ä¸Šèª²æ™‚é–“ï¼Ÿ <span class="icon">+</span></button>
          <div class="faq-answer">
              <p><span class="text-blue">ç›´æ¥é»é¸é€£çµ,è¼¸å…¥æ‚¨çš„è‹±æ–‡åå­—å³å¯çŸ¥é“å³å°‡é–‹å§‹çš„èª²ç¨‹ã€‚</span> <a href="#">ğŸ”—èª²ç¨‹æ™‚æ®µæŸ¥è©¢</a></p>
          </div>
      </div>
      
      <div class="faq-item">
          <button class="faq-question">æˆ‘çš„èª²ç¨‹å¦‚æœé€²è¡Œåˆ°ä¸€åŠ,éœ€è¦æ›´æ”¹èª²ç¨‹æ–¹æ¡ˆ,å¯ä»¥å—ï¼Ÿ <span class="icon">+</span></button>
          <div class="faq-answer">
              <p><span class="text-red">ç•¶ç„¶å¯ä»¥ï¼</span>ç”±æ–¼ç´°ç¯€è¼ƒå¤šï¼Œæœƒéœ€è¦ä»¥å€‹åˆ¥å‚³é€ï¼è«‹æä¾›Line æˆ–æ˜¯Gmail å¸³è™Ÿï¼</p>
          </div>
      </div>
  </div>

</div>


<!-- =========================================
     å®Œå…¨é‚„åŸæ‚¨çš„ JavaScriptï¼ŒåŒ…å« Google Sheets API ä¸²æ¥èˆ‡è¨‚å–®è™Ÿç¢¼
     ========================================= -->
<script>
    const products =[
        { id: 'plan-1', name: 'NT$13,500', price: 13500, description: 'ï¼ˆç´„30å ‚èª²ï¼‰13500é»', bookingLink: null },
        { id: 'plan-2', name: 'NT$27,000', price: 27000, description: 'ï¼ˆç´„62å ‚èª²ï¼‰27900é»', bookingLink: null },
        { id: 'plan-3', name: 'NT$18,000', price: 18000, description: 'ï¼ˆç´„41å ‚èª²ï¼‰18450é»', bookingLink: null },
        { id: 'plan-4', name: 'NT$36,000', price: 36000, description: 'ï¼ˆç´„85å ‚èª²ï¼‰38250é»', bookingLink: null }
    ];
    const images =[
        "https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/5.png?updatedAt=1761542162559",
        "https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/2026.%20%E6%96%B0%E5%A2%9E18000.36000/Abstract%20Special%20Offer%20Announcement%20Free%20Facebook%20Post-4.png",
        "https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/2026.%20%E6%96%B0%E5%A2%9E18000.36000/4.png",
        "https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/2026.%20%E6%96%B0%E5%A2%9E18000.36000/8.png",
        "https://ik.imagekit.io/lql1uveoc/%E6%9C%83%E5%93%A1450/2026.%20%E6%96%B0%E5%A2%9E18000.36000/IMG_A46E23A0A0F7-1.jpeg"
    ];
    let cart = {};
    let currentSlide = 0;
    let autoRotateInterval;
    let touchStartX = 0;

    const productPage = document.getElementById("product-page"),
        thankYouPage = document.getElementById("thank-you-page"),
        addToCartBtn = document.getElementById("add-to-cart-btn"),
        courseOptionsSelect = document.getElementById('course-options'),
        cartIcon = document.getElementById("cart-icon"),
        cartCountSpan = document.getElementById("cart-count"),
        cartOverlay = document.getElementById("cart-overlay"),
        cartPanel = document.getElementById("cart-panel"),
        closeCartBtn = document.getElementById("close-cart-btn-main"),
        cartItemsContainer = document.getElementById("cart-items-container"),
        cartTotalContainer = document.getElementById("cart-total-container"),
        checkoutForm = document.getElementById("checkout-form"),
        emailInput = document.getElementById("email"),
        continueShoppingBtn = document.getElementById("continue-shopping-btn"),
        closeBtn = document.getElementById("close-btn"),
        imageGallery = document.querySelector('.image-gallery'),
        galleryTrack = document.querySelector('.gallery-track'),
        emailPopupOverlay = document.getElementById('email-popup-overlay'),
        popupEmailInput = document.getElementById('popup-email-input'),
        closePopupBtn = document.getElementById('close-popup-btn'),
        popupCheckoutBtn = document.getElementById('popup-checkout-btn');

    function showSlide(index) {
        if (images.length === 0) return;
        if (index >= images.length) { currentSlide = 0; } else if (index < 0) { currentSlide = images.length - 1; } else { currentSlide = index; }
        galleryTrack.style.transform = `translateX(${-currentSlide * 100}%)`;
        if (images.length > 1) { document.querySelectorAll('.gallery-dot').forEach(dot => dot.classList.remove('active')); document.querySelectorAll('.gallery-dot')[currentSlide].classList.add('active'); }
    }

    function nextSlide() { showSlide(currentSlide + 1); }
    function prevSlide() { showSlide(currentSlide - 1); }
    function startAutoRotate() { if (images.length > 1) { stopAutoRotate(); autoRotateInterval = setInterval(nextSlide, 4000); } }
    function stopAutoRotate() { clearInterval(autoRotateInterval); }
    function handleTouchStart(e) { stopAutoRotate(); touchStartX = e.touches[0].clientX; }
    function handleTouchEnd(e) { const touchEndX = e.changedTouches[0].clientX; if (touchStartX - touchEndX > 50) { nextSlide(); } else if (touchEndX - touchStartX > 50) { prevSlide(); } }

    function initGallery() {
        galleryTrack.innerHTML = '';
        if (images.length === 0) { imageGallery.style.display = 'none'; return; }
        images.forEach(src => { galleryTrack.innerHTML += `<div class="gallery-slide"><img src="${src}" alt="èª²ç¨‹å®£å‚³åœ–"></div>`; });
        const existingNav = imageGallery.querySelector('.gallery-nav');
        if (existingNav) existingNav.remove();
        const existingDots = imageGallery.querySelector('.gallery-dots');
        if (existingDots) existingDots.remove();
        if (images.length > 1) {
            imageGallery.insertAdjacentHTML('beforeend', `<div class="gallery-nav"><button class="prev-btn">â€¹</button><button class="next-btn">â€º</button></div>`);
            document.querySelector('.prev-btn').addEventListener('click', () => { stopAutoRotate(); prevSlide(); });
            document.querySelector('.next-btn').addEventListener('click', () => { stopAutoRotate(); nextSlide(); });
            const dotsContainer = document.createElement('div');
            dotsContainer.className = 'gallery-dots';
            images.forEach((_, index) => { dotsContainer.innerHTML += `<div class="gallery-dot" data-index="${index}"></div>`; });
            imageGallery.appendChild(dotsContainer);
            dotsContainer.addEventListener('click', e => { if(e.target.dataset.index) { stopAutoRotate(); showSlide(parseInt(e.target.dataset.index)); } });
            imageGallery.addEventListener('touchstart', handleTouchStart, { passive: true });
            imageGallery.addEventListener('touchend', handleTouchEnd, { passive: true });
            imageGallery.addEventListener('mouseenter', stopAutoRotate);
            imageGallery.addEventListener('mouseleave', startAutoRotate);
            startAutoRotate();
        }
        showSlide(0);
    }

    function populateCourseOptions() {
        courseOptionsSelect.innerHTML = '';
        products.forEach(p => {
            courseOptionsSelect.innerHTML += `<option value="${p.id}">${p.name} ${p.description}</option>`;
        });
    }

    function updateButton() {
        const selectedProduct = products.find(p => p.id === courseOptionsSelect.value);
        if (selectedProduct) {
            addToCartBtn.textContent = `NT$ ${selectedProduct.price.toLocaleString()} | åŠ å…¥è³¼ç‰©è»Š`;
        }
    }

    function handleAddToCart() {
        const productToAdd = products.find(p => p.id === courseOptionsSelect.value);
        if (productToAdd) {
            cart = {}; 
            cart[productToAdd.id] = { ...productToAdd, imageUrl: images.length > 0 ? images[0] : '' };
        }
        updateCartDisplay();
        cartOverlay.classList.add("open");
        cartPanel.classList.add("open");
        setTimeout(() => { emailInput.scrollIntoView({ behavior: 'smooth', block: 'center' }); }, 500);
    }
    
    function calculateTotals() {
        const finalTotal = Object.values(cart).reduce((sum, item) => sum + item.price, 0);
        return { finalTotal };
    }

    function updateCartDisplay() {
        const totalItems = Object.keys(cart).length;
        cartItemsContainer.innerHTML = totalItems > 0 ? '' : '<p>æ‚¨çš„è³¼ç‰©è»Šæ˜¯ç©ºçš„ã€‚</p>';
        
        Object.entries(cart).forEach(([id, item]) => {
            cartItemsContainer.innerHTML += `<div class="cart-item">
                                                 <div class="cart-item-info">
                                                     <div class="cart-item-name">${item.name} ${item.description}</div>
                                                     <button class="remove-item-btn" data-id="${id}">ç§»é™¤</button>
                                                 </div>
                                                 <div class="cart-item-price">NT$ ${item.price.toLocaleString()}</div>
                                             </div>`;
        });
        
        const { finalTotal } = calculateTotals();

        let totalHtml = `<div class="total-row final-total"><span>ç¸½è¨ˆ</span><span>NT$ ${finalTotal.toLocaleString()}</span></div>`;
        cartTotalContainer.innerHTML = totalHtml;

        cartCountSpan.innerText = totalItems;
        cartCountSpan.classList.toggle("visible", totalItems > 0);
    }

    function handleCartInteraction(e) {
        if (e.target.classList.contains("remove-item-btn")) {
            delete cart[e.target.dataset.id];
            updateCartDisplay();
            if (Object.keys(cart).length === 0) { toggleCartPanel(); }
        }
    }

    function showThankYouPage(orderData) {
        let itemsHtml = '';
        orderData.items.forEach(item => {
             itemsHtml += `<div class="ty-order-item">
                              <div class="ty-item-details">
                                  <div class="ty-item-info">${item.name} ${item.description}</div>
                                  <div class="ty-item-price">NT$ ${item.price.toLocaleString()}</div>
                              </div>
                           </div>`;
        });
        document.getElementById('ty-cart-items-container').innerHTML = itemsHtml;

        let totalHtml = `<div class="total-row final-total"><span>ç¸½è¨ˆ</span><span>NT$ ${orderData.totalPrice.toLocaleString()}</span></div>`;
        document.getElementById('ty-total-container').innerHTML = totalHtml;

        document.getElementById('ty-customer-email').innerText = orderData.email;
        document.getElementById('ty-order-id').innerText = orderData.orderId;
        document.getElementById('ty-order-timestamp').innerText = orderData.timestamp;
        const tyBookingContainer = document.getElementById('ty-booking-container');
        const tyBookingLinksList = document.getElementById('ty-booking-links-list');
        if (orderData.bookingLinks && orderData.bookingLinks.length > 0) {
            tyBookingLinksList.innerHTML = '';
            orderData.bookingLinks.forEach(item => { tyBookingLinksList.innerHTML += `<a href="${item.link}" target="_blank" class="ty-booking-link">é»æ­¤é ç´„ï¼š${item.name}</a>`; });
            tyBookingContainer.style.display = 'block';
        } else { tyBookingContainer.style.display = 'none'; }

        productPage.style.display = 'none';
        cartOverlay.classList.remove('open');
        cartPanel.classList.remove('open');
        thankYouPage.style.display = 'block';
    }
    
    // å®Œå…¨é‚„åŸæ‚¨çš„çµå¸³èˆ‡è³‡æ–™å‚³é€å‡½å¼
    function handleCheckout(e) {
      if(e) e.preventDefault();
      const email = popupEmailInput.value;
      if (Object.keys(cart).length === 0) return alert("æ‚¨çš„è³¼ç‰©è»Šæ˜¯ç©ºçš„ï¼");
      if (!email || !email.includes('@')) { alert("è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­ä¿¡ç®±ï¼"); return popupEmailInput.focus(); }
      
      const { finalTotal } = calculateTotals();
      const orderId = '#' + Math.random().toString(36).substr(2, 5).toUpperCase();
      const timestamp = new Date().toLocaleString("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});
      
      popupCheckoutBtn.disabled = true;
      popupCheckoutBtn.innerText = "è™•ç†ä¸­...";
      closeEmailPopup();
      showThankYouPage({
          email, items: Object.values(cart),
          totalPrice: finalTotal,
          orderId, timestamp,
          bookingLinks: Object.values(cart).filter(i => i.bookingLink).map(i => ({ name: i.name, link: i.bookingLink }))
      });

      // ä¸²æ¥è‡³æ‚¨çš„ Google Apps Script
      fetch("https://script.google.com/macros/s/AKfycbyU13Wivs341DMPupk9EKrL9u908zrHNOVqZUXri-hGezkk6qj_7loQGIf0GCfmvj_f/exec", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams({
              orderId, email,
              productName: Object.values(cart).map(item => item.name + ' ' + item.description).join(', '),
              totalPrice: finalTotal, status: "æœªä»˜æ¬¾",
              imageUrls: images.length > 0 ? images[0] : ''
          })
      })
      .then(response => { if (!response.ok) console.error("Error submitting order."); return response.text(); })
      .then(() => { cart = {}; updateCartDisplay(); })
      .catch(e => console.error("Fetch error:", e))
      .finally(() => { popupCheckoutBtn.disabled = false; popupCheckoutBtn.innerText = "ç¢ºèª"; });
    }

    function toggleCartPanel() { cartOverlay.classList.toggle("open"); cartPanel.classList.toggle("open"); }
    function openEmailPopup() { popupEmailInput.value = emailInput.value; emailPopupOverlay.classList.add('visible'); setTimeout(() => popupEmailInput.focus(), 100); }
    function closeEmailPopup() { emailPopupOverlay.classList.remove('visible'); }

    document.addEventListener('DOMContentLoaded', () => {
        initGallery();
        populateCourseOptions();
        updateButton();
        updateCartDisplay();

        courseOptionsSelect.addEventListener('change', updateButton);
        addToCartBtn.addEventListener("click", handleAddToCart);
        cartIcon.addEventListener("click", toggleCartPanel);
        closeCartBtn.addEventListener("click", toggleCartPanel);
        cartOverlay.addEventListener("click", (e) => { if(e.target === cartOverlay) toggleCartPanel(); });
        cartItemsContainer.addEventListener("click", handleCartInteraction);
        
        const resetToProductPage = (e) => { e.preventDefault(); thankYouPage.style.display = 'none'; productPage.style.display = 'block'; };
        continueShoppingBtn.addEventListener('click', resetToProductPage);
        closeBtn.addEventListener('click', resetToProductPage);
        
        emailInput.addEventListener('click', openEmailPopup);
        closePopupBtn.addEventListener('click', closeEmailPopup);
        popupCheckoutBtn.addEventListener('click', handleCheckout);
        emailPopupOverlay.addEventListener('click', (e) => { if (e.target === emailPopupOverlay) closeEmailPopup(); });
        
        popupEmailInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                event.preventDefault();
                handleCheckout();
            }
        });
        
        popupEmailInput.addEventListener('input', () => emailInput.value = popupEmailInput.value);

        // å¸¸è¦‹å•é¡Œ FAQ é»æ“Šæ”¶åˆé‚è¼¯
        const faqs = document.querySelectorAll(".faq-question");
        faqs.forEach(faq => {
            faq.addEventListener("click", () => {
                faq.classList.toggle("active");
                let panel = faq.nextElementSibling;
                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                } else {
                    panel.style.maxHeight = panel.scrollHeight + "px";
                }
            });
        });
    });
</script>
</body>
</html>
